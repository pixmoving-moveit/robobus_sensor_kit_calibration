<launch>
    <arg name="apriltag_detections_topic" default="/apriltag/detection_array" />
    <let name="input_image_raw" value="/sensing/camera/top/gmsl/image_raw" />
    <let name="input_camera_info" value="/sensing/camera/top/gmsl/camera_info" />
    <let name="output_image_raw" value="/sensing/camera/top/gmsl/rectified/image_raw" />
    <let name="output_camera_info" value="/sensing/camera/top/gmsl/rectified/camera_info" />


    <!-- camera rect  -->
    <include file="$(find-pkg-share robobus_sensor_kit_calibration)/launch/camera_rectified/image_rectified.launch.py" >
        <arg name="input_image_raw" value="$(var input_image_raw)"/>
        <arg name="input_camera_info" value="$(var input_camera_info)"/>
        <arg name="output_image_raw" value="$(var output_image_raw)"/>
        <arg name="output_camera_info" value="$(var output_camera_info)"/>
    </include>


    <!-- apriltag detection -->
    <include file="$(find-pkg-share robobus_sensor_kit_calibration)/launch/extrinsic_tag_based_calibrator/apriltag_16h5.launch.py" >
        <arg name="image_topic" value="$(var output_image_raw)"/>
        <arg name="camera_info_topic" value="$(var output_camera_info)"/>
        <arg name="apriltag_detections_topic" value="$(var apriltag_detections_topic)"/>
    </include>

    <!-- apriltag rviz-->
    <include file="$(find-pkg-share robobus_sensor_kit_calibration)/launch/cameratag_viz/viz.launch.py" >
        <arg name="image_topic" value="$(var output_image_raw)"/>
        <arg name="detections" value="$(var apriltag_detections_topic)"/>
    </include>
</launch>
